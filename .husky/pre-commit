#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Run lint-staged (linting and formatting)
echo "ğŸ“ Running lint-staged..."
npx lint-staged || {
  echo "âŒ Lint-staged failed. Please fix the issues and try again."
  exit 1
}

# Run tests (only for staged files to speed up)
echo "ğŸ§ª Running tests..."
npm run test --prefix backend -- --bail --findRelatedTests || {
  echo "âŒ Backend tests failed. Please fix the issues and try again."
  exit 1
}

npm run test --prefix frontend -- --run --bail || {
  echo "âŒ Frontend tests failed. Please fix the issues and try again."
  exit 1
}

echo "âœ… All pre-commit checks passed!"
